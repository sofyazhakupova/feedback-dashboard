<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Review Analytics Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --github-bg: #ffffff;
            --github-bg-secondary: #f6f8fa;
            --github-border: #d1d9e0;
            --github-border-light: #e1e4e8;
            --github-text: #24292f;
            --github-text-secondary: #656d76;
            --github-text-muted: #8b949e;
            --github-accent: #0969da;
            --github-accent-hover: #0860ca;
            --github-success: #1a7f37;
            --github-warning: #9a6700;
            --github-danger: #d1242f;
        }

        * {
            box-sizing: border-box;
        }

        body { 
            background: var(--github-bg);
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            color: var(--github-text);
            line-height: 1.5;
            font-size: 14px;
        }

        .main-container {
            background: var(--github-bg);
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin: 16px;
            padding: 0;
            border: 1px solid var(--github-border);
        }

        /* Header */
        .header-section {
            background: var(--github-bg-secondary);
            color: var(--github-text);
            padding: 24px 0;
            margin-bottom: 0;
            border-bottom: 1px solid var(--github-border);
        }

        .header-title {
            color: var(--github-text);
            font-weight: 600;
            font-size: 24px;
            margin: 0;
        }

        .header-subtitle {
            color: var(--github-text-secondary);
            font-weight: 400;
            font-size: 16px;
            margin: 4px 0 0 0;
        }

        /* Navigation */
        .nav-tabs {
            border: none;
            background: var(--github-bg);
            padding: 0 16px;
            margin: 0;
        }

        .nav-tabs .nav-link {
            border: none;
            border-radius: 6px 6px 0 0;
            margin-right: 4px;
            background: transparent;
            color: var(--github-text-secondary);
            font-weight: 500;
            padding: 8px 16px;
            border-bottom: 2px solid transparent;
            transition: all 0.15s ease;
            font-size: 14px;
        }

        .nav-tabs .nav-link:hover {
            background: var(--github-bg-secondary);
            color: var(--github-text);
            border-bottom-color: var(--github-border);
        }

        .nav-tabs .nav-link.active {
            background: var(--github-bg);
            color: var(--github-text);
            border-bottom-color: var(--github-accent);
            font-weight: 600;
        }

        .tab-content {
            background: var(--github-bg);
            border-radius: 0;
            padding: 24px;
            box-shadow: none;
            border: none;
        }

        /* Cards */
        .metric-card { 
            background: var(--github-bg);
            color: var(--github-text);
            border-radius: 6px;
            border: 1px solid var(--github-border);
            transition: all 0.15s ease;
            padding: 16px;
        }

        .metric-card:hover {
            border-color: var(--github-border-light);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .metric-card h2 { 
            font-size: 24px; 
            font-weight: 600;
            color: var(--github-text);
            margin: 0;
        }

        .metric-card h4 {
            font-weight: 500;
            color: var(--github-text-secondary);
            font-size: 14px;
            margin: 0 0 8px 0;
        }

        .chart-card {
            border-radius: 6px;
            box-shadow: none;
            border: 1px solid var(--github-border);
        }

        .chart-header {
            background: var(--github-bg-secondary);
            color: var(--github-text);
            border-radius: 6px 6px 0 0;
            padding: 12px 16px;
            border-bottom: 1px solid var(--github-border);
        }

        .chart-header h5 {
            font-weight: 600;
            font-size: 14px;
            margin: 0;
            color: var(--github-text);
        }

        /* Filters */
        .filter-section {
            background: var(--github-bg-secondary);
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 16px;
            border: 1px solid var(--github-border);
        }

        .filter-section h5 {
            font-weight: 600;
            color: var(--github-text);
            font-size: 14px;
            margin: 0 0 12px 0;
        }

        /* Buttons */
        .btn {
            border-radius: 6px;
            font-weight: 500;
            font-size: 14px;
            padding: 6px 12px;
            border: 1px solid var(--github-border);
            transition: all 0.15s ease;
        }

        .btn-primary {
            background: var(--github-accent);
            color: white;
            border-color: var(--github-accent);
        }

        .btn-primary:hover {
            background: var(--github-accent-hover);
            border-color: var(--github-accent-hover);
        }

        .btn-outline-primary {
            background: transparent;
            color: var(--github-accent);
            border-color: var(--github-accent);
        }

        .btn-outline-primary:hover {
            background: var(--github-accent);
            color: white;
        }

        .btn-outline-secondary {
            background: transparent;
            color: var(--github-text-secondary);
            border-color: var(--github-border);
        }

        .btn-outline-secondary:hover {
            background: var(--github-bg-secondary);
            border-color: var(--github-border-light);
        }

        .btn-outline-danger {
            background: transparent;
            color: var(--github-danger);
            border-color: var(--github-danger);
        }

        .btn-outline-danger:hover {
            background: var(--github-danger);
            color: white;
        }

        /* Source Cards */
        .source-card {
            background: var(--github-bg);
            border-radius: 6px;
            padding: 16px;
            text-align: center;
            transition: all 0.15s ease;
            border: 1px solid var(--github-border);
        }

        .source-card:hover {
            border-color: var(--github-border-light);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .source-card.active {
            border-color: var(--github-accent);
            background: var(--github-bg-secondary);
        }

        .source-card.inactive {
            border-color: var(--github-border);
            background: var(--github-bg-secondary);
            opacity: 0.6;
        }

        .add-source-card {
            border: 2px dashed var(--github-border);
            background: var(--github-bg-secondary);
            color: var(--github-text-secondary);
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .add-source-card:hover {
            background: var(--github-accent);
            color: white;
            border-color: var(--github-accent);
        }

        /* Tables */
        .data-table {
            background: var(--github-bg);
            border-radius: 6px;
            overflow: hidden;
            box-shadow: none;
            border: 1px solid var(--github-border);
        }

        .table th {
            background: var(--github-bg-secondary);
            color: var(--github-text);
            border: none;
            font-weight: 600;
            font-size: 12px;
            padding: 12px 16px;
            border-bottom: 1px solid var(--github-border);
        }

        .table td {
            border-color: var(--github-border);
            vertical-align: middle;
            padding: 12px 16px;
            font-size: 14px;
        }

        .table-hover tbody tr:hover {
            background-color: var(--github-bg-secondary);
        }

        /* Badges */
        .badge {
            border-radius: 12px;
            font-weight: 500;
            font-size: 12px;
            padding: 4px 8px;
        }

        .badge-source {
            background: var(--github-accent);
            color: white;
        }

        /* Form Controls */
        .form-control, .form-select {
            border-radius: 6px;
            border: 1px solid var(--github-border);
            padding: 8px 12px;
            font-weight: 400;
            font-size: 14px;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--github-accent);
            box-shadow: 0 0 0 3px rgba(9, 105, 218, 0.1);
        }

        /* Alerts */
        .alert {
            border-radius: 0;
            border: 1px solid var(--light-gray);
            font-weight: 400;
        }

        .alert-info {
            background: var(--secondary-white);
            color: var(--primary-black);
            border-color: var(--light-gray);
        }

        /* Modal */
        .modal-content {
            border-radius: 0;
            border: 1px solid var(--primary-black);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        .modal-header {
            background: var(--primary-black);
            color: var(--primary-white);
            border-radius: 0;
            border-bottom: 1px solid var(--primary-black);
        }

        .modal-header h5 {
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-close-white {
            filter: invert(1);
        }

        /* Pagination */
        .pagination .page-link {
            border-radius: 0;
            border: 1px solid var(--light-gray);
            color: var(--primary-black);
            padding: 0.75rem 1rem;
        }

        .pagination .page-link:hover {
            background: var(--secondary-white);
            border-color: var(--primary-black);
        }

        .pagination .page-item.active .page-link {
            background: var(--primary-black);
            border-color: var(--primary-black);
        }

        /* Footer */
        .footer-section {
            background: var(--secondary-white);
            border-top: 1px solid var(--light-gray);
            padding: 2rem;
            margin-top: 2rem;
        }

        .footer-section p {
            color: var(--medium-gray);
            font-weight: 300;
            font-size: 0.9rem;
        }

        /* Live indicator */
        .live-indicator {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header-title {
                font-size: 2rem;
            }
            
            .tab-content {
                padding: 1rem;
            }
            
            .filter-section {
                padding: 1rem;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--secondary-white);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-black);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-black);
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Header -->
        <div class="header-section">
            <div class="container">
                <div class="row">
                    <div class="col-12 text-center">
                        <h1 class="header-title mb-3">
                            <i class="fas fa-chart-line me-3"></i>
                            App Review Analytics
                        </h1>
                        <p class="header-subtitle">
                            <i class="fas fa-sync-alt live-indicator me-2"></i>
                            Real-time insights from app stores, support tickets, and surveys
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab">
                    <i class="fas fa-chart-pie me-2"></i>Dashboard
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="list-tab" data-bs-toggle="tab" data-bs-target="#list" type="button" role="tab">
                    <i class="fas fa-list me-2"></i>Reviews List
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="sources-tab" data-bs-toggle="tab" data-bs-target="#sources" type="button" role="tab">
                    <i class="fas fa-cog me-2"></i>Data Sources
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="dashboardTabsContent">
            
            <!-- Dashboard Tab -->
            <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
                
                <!-- Time Period Selector -->
                <div class="filter-section">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h5 class="mb-0">
                                <i class="fas fa-calendar-alt me-2"></i>
                                Time Period
                            </h5>
                        </div>
                        <div class="col-md-6">
                            <div class="btn-group w-100" role="group">
                                <input type="radio" class="btn-check" name="timePeriod" id="last7days" value="7">
                                <label class="btn btn-outline-primary" for="last7days">Last 7 days</label>

                                <input type="radio" class="btn-check" name="timePeriod" id="lastMonth" value="30">
                                <label class="btn btn-outline-primary" for="lastMonth">Last month</label>

                                <input type="radio" class="btn-check" name="timePeriod" id="last3Months" value="90">
                                <label class="btn btn-outline-primary" for="last3Months">3 months</label>

                                <input type="radio" class="btn-check" name="timePeriod" id="last6Months" value="180">
                                <label class="btn btn-outline-primary" for="last6Months">6 months</label>

                                <input type="radio" class="btn-check" name="timePeriod" id="lastYear" value="365">
                                <label class="btn btn-outline-primary" for="lastYear">1 year</label>

                                <input type="radio" class="btn-check" name="timePeriod" id="allTime" value="0" checked>
                                <label class="btn btn-outline-primary" for="allTime">All time</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Overview Cards -->
                <div class="row mb-5">
                    <div class="col-lg-3 col-md-6 mb-4">
                        <div class="card metric-card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-comments fa-2x mb-3" style="color: var(--primary-black);"></i>
                                <h4 class="card-title">Total Reviews</h4>
                                <h2 id="total-reviews">0</h2>
                                <small style="color: var(--medium-gray);">No data loaded</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4">
                        <div class="card metric-card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-star fa-2x mb-3" style="color: var(--primary-black);"></i>
                                <h4 class="card-title">Avg Rating</h4>
                                <h2 id="avg-rating">N/A</h2>
                                <small style="color: var(--medium-gray);">No data loaded</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4">
                        <div class="card metric-card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-smile fa-2x mb-3" style="color: var(--primary-black);"></i>
                                <h4 class="card-title">Positive Sentiment</h4>
                                <h2 id="positive-sentiment">N/A</h2>
                                <small style="color: var(--medium-gray);">No data loaded</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4">
                        <div class="card metric-card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-database fa-2x mb-3" style="color: var(--primary-black);"></i>
                                <h4 class="card-title">Data Sources</h4>
                                <h2 id="sources-count">0</h2>
                                <small style="color: var(--medium-gray);">No sources added</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="row mb-5">
                    <div class="col-lg-6 mb-4">
                        <div class="card chart-card h-100">
                            <div class="chart-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-pie-chart me-2"></i>
                                    Sentiment Distribution
                                </h5>
                            </div>
                            <div class="card-body p-4">
                                <div id="sentiment-chart" style="height: 350px;">
                                    <div class="d-flex align-items-center justify-content-center h-100" style="color: var(--medium-gray);">
                                        <div class="text-center">
                                            <i class="fas fa-chart-pie fa-3x mb-3"></i>
                                            <p>No data available</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 mb-4">
                        <div class="card chart-card h-100">
                            <div class="chart-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-mobile-alt me-2"></i>
                                    Source Distribution
                                </h5>
                            </div>
                            <div class="card-body p-4">
                                <div id="source-chart" style="height: 350px;">
                                    <div class="d-flex align-items-center justify-content-center h-100" style="color: var(--medium-gray);">
                                        <div class="text-center">
                                            <i class="fas fa-mobile-alt fa-3x mb-3"></i>
                                            <p>No data available</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Rating and Trends -->
                <div class="row mb-5">
                    <div class="col-lg-6 mb-4">
                        <div class="card chart-card h-100">
                            <div class="chart-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-star me-2"></i>
                                    Rating Distribution
                                </h5>
                            </div>
                            <div class="card-body p-4">
                                <div id="rating-chart" style="height: 350px;">
                                    <div class="d-flex align-items-center justify-content-center h-100" style="color: var(--medium-gray);">
                                        <div class="text-center">
                                            <i class="fas fa-star fa-3x mb-3"></i>
                                            <p>No data available</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 mb-4">
                        <div class="card chart-card h-100">
                            <div class="chart-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-line me-2"></i>
                                    Trends Over Time
                                </h5>
                            </div>
                            <div class="card-body p-4">
                                <div id="trends-chart" style="height: 350px;">
                                    <div class="d-flex align-items-center justify-content-center h-100" style="color: var(--medium-gray);">
                                        <div class="text-center">
                                            <i class="fas fa-chart-line fa-3x mb-3"></i>
                                            <p>No data available</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reviews List Tab -->
            <div class="tab-pane fade" id="list" role="tabpanel">
                <h4 class="mb-4" style="font-weight: 600; font-size: 20px;">
                    <i class="fas fa-list me-2"></i>
                    All Reviews & Comments
                </h4>

                <!-- Time Period Selector for List -->
                <div class="filter-section">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h5 class="mb-0">
                                <i class="fas fa-calendar-alt me-2"></i>
                                Time Period
                            </h5>
                        </div>
                        <div class="col-md-6">
                            <div class="btn-group w-100" role="group">
                                <input type="radio" class="btn-check" name="timePeriodList" id="last7daysList" value="7">
                                <label class="btn btn-outline-primary" for="last7daysList">Last 7 days</label>

                                <input type="radio" class="btn-check" name="timePeriodList" id="lastMonthList" value="30">
                                <label class="btn btn-outline-primary" for="lastMonthList">Last month</label>

                                <input type="radio" class="btn-check" name="timePeriodList" id="last3MonthsList" value="90">
                                <label class="btn btn-outline-primary" for="last3MonthsList">3 months</label>

                                <input type="radio" class="btn-check" name="timePeriodList" id="last6MonthsList" value="180">
                                <label class="btn btn-outline-primary" for="last6MonthsList">6 months</label>

                                <input type="radio" class="btn-check" name="timePeriodList" id="lastYearList" value="365">
                                <label class="btn btn-outline-primary" for="lastYearList">1 year</label>

                                <input type="radio" class="btn-check" name="timePeriodList" id="allTimeList" value="0" checked>
                                <label class="btn btn-outline-primary" for="allTimeList">All time</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="filter-section">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Source Filter</label>
                            <select class="form-select" id="sourceFilter">
                                <option value="">All Sources</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">User Type</label>
                            <select class="form-select" id="userTypeFilter">
                                <option value="">All Users</option>
                                <option value="premium">Premium Users</option>
                                <option value="free">Free Users</option>
                                <option value="unknown">Unknown</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Rating Filter</label>
                            <select class="form-select" id="ratingFilter">
                                <option value="">All Ratings</option>
                                <option value="5">5 Stars</option>
                                <option value="4">4 Stars</option>
                                <option value="3">3 Stars</option>
                                <option value="2">2 Stars</option>
                                <option value="1">1 Star</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Keyword Search</label>
                            <input type="text" class="form-control" id="keywordSearch" placeholder="Search keywords...">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Date Range</label>
                            <div class="row">
                                <div class="col-6">
                                    <input type="date" class="form-control" id="startDate">
                                </div>
                                <div class="col-6">
                                    <input type="date" class="form-control" id="endDate">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3 d-flex align-items-end">
                            <button class="btn btn-primary me-2" onclick="applyFilters()">
                                <i class="fas fa-filter me-2"></i>Apply Filters
                            </button>
                            <button class="btn btn-outline-secondary" onclick="clearFilters()">
                                <i class="fas fa-times me-2"></i>Clear
                            </button>
                        </div>
                    </div>
                    
                    <!-- Keyword Tags Cloud -->
                    <div class="row mt-3">
                        <div class="col-12">
                            <label class="form-label">Quick Keyword Filters</label>
                            <div id="keywordTags" class="mb-3">
                                <span class="badge bg-light text-dark me-2 mb-2" style="cursor: pointer; border: 1px solid var(--light-gray);" onclick="addKeywordFilter('')">
                                    <i class="fas fa-times me-1"></i>Clear All
                                </span>
                                <!-- Keywords will be dynamically added here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Summary -->
                <div class="row mb-3">
                    <div class="col-12">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            Showing <strong id="resultsCount">0</strong> reviews
                            <span id="filterSummary" class="ms-3"></span>
                        </div>
                    </div>
                </div>

                <!-- Reviews Table -->
                <div class="data-table">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Source</th>
                                    <th>User Name</th>
                                    <th>User Type</th>
                                    <th>Message</th>
                                    <th>Rating</th>
                                    <th>Keywords</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="reviewsTableBody">
                                <tr>
                                    <td colspan="8" class="text-center" style="color: var(--medium-gray); padding: 3rem;">
                                        <i class="fas fa-database fa-3x mb-3"></i>
                                        <p>No data loaded. Upload CSV files in the Data Sources tab.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Data Sources Tab -->
            <div class="tab-pane fade" id="sources" role="tabpanel">
                <div class="row mb-4">
                    <div class="col-md-8">
                        <h4 class="mb-0" style="font-weight: 300;">
                            <i class="fas fa-cog me-2"></i>
                            Data Sources Management
                        </h4>
                        <p style="color: var(--medium-gray);">Configure and manage your data sources</p>
                    </div>
                    <div class="col-md-4 text-end">
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addSourceModal">
                            <i class="fas fa-plus me-2"></i>Add New Source
                        </button>
                    </div>
                </div>

                <!-- Existing Sources -->
                <div class="row mb-4" id="sourcesContainer">
                    <!-- Sources will be dynamically added here -->
                </div>

                <!-- Add New Source Placeholder -->
                <div class="row">
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="source-card add-source-card" data-bs-toggle="modal" data-bs-target="#addSourceModal">
                            <i class="fas fa-plus fa-3x mb-3"></i>
                            <h6 class="fw-bold">Add New Source</h6>
                            <p class="small mb-0">Click to add CSV file or API source</p>
                        </div>
                    </div>
                </div>

                <!-- Source Configuration Help -->
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card" style="border: 1px solid var(--light-gray);">
                            <div class="card-header" style="background: var(--secondary-white); border-bottom: 1px solid var(--light-gray);">
                                <h5 class="mb-0" style="font-weight: 400;">
                                    <i class="fas fa-question-circle me-2"></i>
                                    Source Configuration Guide
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 style="font-weight: 400;">Supported File Formats</h6>
                                        <ul class="list-unstyled">
                                            <li><i class="fas fa-check me-2" style="color: var(--primary-black);"></i>CSV Files (.csv)</li>
                                            <li><i class="fas fa-check me-2" style="color: var(--primary-black);"></i>Excel Files (.xlsx)</li>
                                            <li><i class="fas fa-check me-2" style="color: var(--primary-black);"></i>JSON Files (.json)</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 style="font-weight: 400;">Required CSV Columns</h6>
                                        <ul class="list-unstyled">
                                            <li><i class="fas fa-info-circle me-2" style="color: var(--medium-gray);"></i>date, source, content</li>
                                            <li><i class="fas fa-info-circle me-2" style="color: var(--medium-gray);"></i>rating, author, sentiment</li>
                                            <li><i class="fas fa-info-circle me-2" style="color: var(--medium-gray);"></i>category, metadata (optional)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer-section">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-2">
                        <strong>App Review Analytics Dashboard</strong> | 
                        <i class="fas fa-sync-alt live-indicator me-1"></i>
                        Live Data | 
                        Last Updated: <span id="last-updated"></span>
                    </p>
                    <p class="small">
                        <i class="fas fa-share-alt me-1"></i>
                        Share this dashboard with your team: 
                        <strong>https://yourusername.github.io/app-review-dashboard/</strong>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Source Modal -->
    <div class="modal fade" id="addSourceModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-plus me-2"></i>
                        Add New Data Source
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addSourceForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Source Type</label>
                                <select class="form-select" id="sourceType" required>
                                    <option value="">Select source type</option>
                                    <option value="csv">CSV Upload</option>
                                    <option value="excel">Excel File</option>
                                    <option value="json">JSON File</option>
                                    <option value="api">API Integration</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Source Name</label>
                                <input type="text" class="form-control" id="sourceName" placeholder="e.g., Customer Reviews" required>
                            </div>
                        </div>
                        
                        <div id="fileConfig">
                            <h6 class="mb-3" style="font-weight: 400;">File Configuration</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Upload File</label>
                                    <input type="file" class="form-control" id="fileUpload" accept=".csv,.xlsx,.json" required>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">File Format</label>
                                    <select class="form-select" id="fileFormat">
                                        <option value="csv">CSV</option>
                                        <option value="excel">Excel</option>
                                        <option value="json">JSON</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div id="apiConfig" style="display: none;">
                            <h6 class="mb-3" style="font-weight: 400;">API Configuration</h6>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">API URL</label>
                                    <input type="url" class="form-control" id="apiUrl" placeholder="https://api.example.com/endpoint">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">API Key</label>
                                    <input type="password" class="form-control" id="apiKey" placeholder="Your API key">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Update Frequency</label>
                                    <select class="form-select" id="updateFrequency">
                                        <option value="hourly">Every Hour</option>
                                        <option value="daily">Daily</option>
                                        <option value="weekly">Weekly</option>
                                        <option value="manual">Manual Only</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Data Limit</label>
                                    <input type="number" class="form-control" id="dataLimit" placeholder="100" value="100">
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="sourceDescription" rows="3" placeholder="Describe this data source..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveSource()">
                        <i class="fas fa-save me-2"></i>Save Source
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global data storage
        let allReviews = [];
        let dataSources = [];

        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateTime();
            setInterval(updateTime, 60000);
            updateSourceCount();
        });

        function setupEventListeners() {
            // Time period selector for Dashboard
            document.querySelectorAll('input[name="timePeriod"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    updateDashboardForPeriod(this.value);
                });
            });

            // Time period selector for List
            document.querySelectorAll('input[name="timePeriodList"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    updateListForPeriod(this.value);
                });
            });

            // Source type selector in modal
            document.getElementById('sourceType').addEventListener('change', function() {
                const apiConfig = document.getElementById('apiConfig');
                const fileConfig = document.getElementById('fileConfig');
                
                if (this.value === 'api') {
                    apiConfig.style.display = 'block';
                    fileConfig.style.display = 'none';
                } else if (['csv', 'excel', 'json'].includes(this.value)) {
                    apiConfig.style.display = 'none';
                    fileConfig.style.display = 'block';
                } else {
                    apiConfig.style.display = 'none';
                    fileConfig.style.display = 'none';
                }
            });

            // File upload handler
            document.getElementById('fileUpload').addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    const fileName = file.name;
                    document.getElementById('sourceName').value = fileName.replace(/\.[^/.]+$/, "");
                }
            });
        }

        function updateDashboardForPeriod(days) {
            console.log(`Updating dashboard for last ${days} days`);
            
            if (allReviews.length === 0) {
                return;
            }

            let filteredReviews;
            
            if (days === 0) {
                // All time - no filtering
                filteredReviews = allReviews;
            } else {
                // Filter reviews by date
                const cutoffDate = new Date();
                cutoffDate.setDate(cutoffDate.getDate() - days);
                
                filteredReviews = allReviews.filter(review => {
                    const reviewDate = new Date(review.date);
                    return reviewDate >= cutoffDate;
                });
            }

            updateDashboardMetrics(filteredReviews);
        }

        function updateListForPeriod(days) {
            console.log(`Updating list for last ${days} days`);
            
            if (allReviews.length === 0) {
                return;
            }

            let filteredReviews;
            
            if (days === 0) {
                // All time - no filtering
                filteredReviews = allReviews;
            } else {
                // Filter reviews by date
                const cutoffDate = new Date();
                cutoffDate.setDate(cutoffDate.getDate() - days);
                
                filteredReviews = allReviews.filter(review => {
                    const reviewDate = new Date(review.date);
                    return reviewDate >= cutoffDate;
                });
            }

            // Update the table with filtered data
            updateFilteredTable(filteredReviews);
            
            // Update results count
            document.getElementById('resultsCount').textContent = filteredReviews.length;
        }

        function updateDashboardMetrics(reviews) {
            if (reviews.length === 0) {
                document.getElementById('total-reviews').textContent = '0';
                document.getElementById('avg-rating').textContent = 'N/A';
                document.getElementById('positive-sentiment').textContent = 'N/A';
                return;
            }

            // Update total reviews
            document.getElementById('total-reviews').textContent = reviews.length.toLocaleString();

            // Calculate average rating
            const reviewsWithRating = reviews.filter(r => r.rating && !isNaN(r.rating));
            if (reviewsWithRating.length > 0) {
                const avgRating = reviewsWithRating.reduce((sum, r) => sum + r.rating, 0) / reviewsWithRating.length;
                document.getElementById('avg-rating').textContent = avgRating.toFixed(1);
            } else {
                document.getElementById('avg-rating').textContent = 'N/A';
            }

            // Calculate positive sentiment percentage
            const positiveReviews = reviews.filter(r => r.sentiment === 'positive');
            const positivePercentage = (positiveReviews.length / reviews.length) * 100;
            document.getElementById('positive-sentiment').textContent = positivePercentage.toFixed(1) + '%';

            // Update charts
            updateCharts(reviews);
        }

        function updateCharts(reviews) {
            if (reviews.length === 0) {
                // Clear charts
                document.getElementById('sentiment-chart').innerHTML = '<div class="d-flex align-items-center justify-content-center h-100" style="color: var(--medium-gray);"><div class="text-center"><i class="fas fa-chart-pie fa-3x mb-3"></i><p>No data available</p></div></div>';
                document.getElementById('source-chart').innerHTML = '<div class="d-flex align-items-center justify-content-center h-100" style="color: var(--medium-gray);"><div class="text-center"><i class="fas fa-mobile-alt fa-3x mb-3"></i><p>No data available</p></div></div>';
                document.getElementById('rating-chart').innerHTML = '<div class="d-flex align-items-center justify-content-center h-100" style="color: var(--medium-gray);"><div class="text-center"><i class="fas fa-star fa-3x mb-3"></i><p>No data available</p></div></div>';
                document.getElementById('trends-chart').innerHTML = '<div class="d-flex align-items-center justify-content-center h-100" style="color: var(--medium-gray);"><div class="text-center"><i class="fas fa-chart-line fa-3x mb-3"></i><p>No data available</p></div></div>';
                return;
            }

            // Sentiment chart
            const sentimentCounts = {};
            reviews.forEach(review => {
                const sentiment = review.sentiment || 'unknown';
                sentimentCounts[sentiment] = (sentimentCounts[sentiment] || 0) + 1;
            });

            const sentimentData = {
                values: Object.values(sentimentCounts),
                labels: Object.keys(sentimentCounts),
                type: 'pie',
                marker: { 
                    colors: ['#0969da', '#656d76', '#8b949e'],
                    line: { color: '#ffffff', width: 1 }
                }
            };

            Plotly.newPlot('sentiment-chart', [sentimentData], {
                margin: { t: 20, b: 20, l: 20, r: 20 },
                showlegend: true,
                legend: { orientation: 'h', y: -0.1 },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#24292f', size: 12 }
            });

            // Source chart
            const sourceCounts = {};
            reviews.forEach(review => {
                const source = review.source || 'unknown';
                sourceCounts[source] = (sourceCounts[source] || 0) + 1;
            });

            const sourceData = {
                x: Object.keys(sourceCounts),
                y: Object.values(sourceCounts),
                type: 'bar',
                marker: { 
                    color: '#0969da',
                    line: { color: '#ffffff', width: 1 }
                }
            };

            Plotly.newPlot('source-chart', [sourceData], {
                margin: { t: 20, b: 20, l: 20, r: 20 },
                xaxis: { title: 'Data Source' },
                yaxis: { title: 'Number of Reviews' },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#24292f', size: 12 }
            });

            // Rating chart
            const ratingCounts = {};
            reviews.forEach(review => {
                if (review.rating && !isNaN(review.rating)) {
                    const rating = Math.round(review.rating);
                    ratingCounts[rating] = (ratingCounts[rating] || 0) + 1;
                }
            });

            if (Object.keys(ratingCounts).length > 0) {
                const ratingData = {
                    x: Object.keys(ratingCounts).map(r => r),
                    y: Object.values(ratingCounts),
                    type: 'bar',
                    marker: { 
                        color: '#0969da',
                        line: { color: '#ffffff', width: 1 }
                    }
                };

                Plotly.newPlot('rating-chart', [ratingData], {
                    margin: { t: 20, b: 20, l: 20, r: 20 },
                    xaxis: { title: 'Rating' },
                    yaxis: { title: 'Number of Reviews' },
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(0,0,0,0)',
                    font: { color: '#24292f', size: 12 }
                });
            }

            // Trends chart (simplified - by month)
            const monthlyCounts = {};
            reviews.forEach(review => {
                const date = new Date(review.date);
                const monthKey = date.getFullYear() + '-' + String(date.getMonth() + 1).padStart(2, '0');
                monthlyCounts[monthKey] = (monthlyCounts[monthKey] || 0) + 1;
            });

            const sortedMonths = Object.keys(monthlyCounts).sort();
            const trendsData = {
                x: sortedMonths,
                y: sortedMonths.map(month => monthlyCounts[month]),
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#0969da', width: 2 },
                marker: { size: 6, color: '#0969da' }
            };

            Plotly.newPlot('trends-chart', [trendsData], {
                margin: { t: 20, b: 20, l: 20, r: 20 },
                xaxis: { title: 'Time Period' },
                yaxis: { title: 'Number of Reviews' },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#24292f', size: 12 }
            });
        }

        function saveSource() {
            const form = document.getElementById('addSourceForm');
            const sourceType = document.getElementById('sourceType').value;
            const sourceName = document.getElementById('sourceName').value;
            const fileInput = document.getElementById('fileUpload');
            const description = document.getElementById('sourceDescription').value;

            if (!sourceName) {
                alert('Please enter a source name');
                return;
            }

            if (sourceType === 'csv' || sourceType === 'excel' || sourceType === 'json') {
                if (!fileInput.files[0]) {
                    alert('Please select a file to upload');
                    return;
                }

                const file = fileInput.files[0];
                const reader = new FileReader();

                reader.onload = function(e) {
                    try {
                        let data;
                        if (sourceType === 'csv') {
                            data = parseCSV(e.target.result);
                        } else if (sourceType === 'json') {
                            data = JSON.parse(e.target.result);
                        } else {
                            alert('Excel files not yet supported. Please convert to CSV.');
                            return;
                        }

                        // Validate data structure
                        if (!validateDataStructure(data)) {
                            alert('Invalid data structure. Please ensure your file has the required columns: date, source, content');
                            return;
                        }

                        // Add to data sources
                        const newSource = {
                            id: Date.now(),
                            name: sourceName,
                            type: sourceType,
                            description: description,
                            data: data,
                            createdAt: new Date().toISOString()
                        };

                        dataSources.push(newSource);
                        allReviews = allReviews.concat(data);

                        // Update UI
                        updateSourceCount();
                        updateSourceList();
                        updateDashboardMetrics(allReviews);
                        updateReviewsTable();
                        updateSourceFilter();

                        // Close modal
                        const modal = bootstrap.Modal.getInstance(document.getElementById('addSourceModal'));
                        modal.hide();

                        // Reset form
                        form.reset();
                        document.getElementById('apiConfig').style.display = 'none';
                        document.getElementById('fileConfig').style.display = 'block';

                        alert(`Successfully loaded ${data.length} reviews from ${sourceName}`);

                    } catch (error) {
                        alert('Error parsing file: ' + error.message);
                    }
                };

                reader.readAsText(file);
            } else {
                alert('API integration not yet implemented');
            }
        }

        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = lines[i].split(',').map(v => v.trim().replace(/"/g, ''));
                    const row = {};
                    headers.forEach((header, index) => {
                        row[header] = values[index] || '';
                    });
                    data.push(row);
                }
            }

            return data;
        }

        function validateDataStructure(data) {
            if (!Array.isArray(data) || data.length === 0) {
                return false;
            }

            const requiredFields = ['date', 'content']; // Only date and content are required
            const firstRow = data[0];
            
            return requiredFields.every(field => firstRow.hasOwnProperty(field));
        }

        function analyzeUserType(message, author) {
            if (!message) return 'unknown';
            
            const messageLower = message.toLowerCase();
            const authorLower = (author || '').toLowerCase();
            
            // Premium indicators
            const premiumKeywords = [
                'premium', 'pro', 'paid', 'subscription', 'upgrade', 'paid version',
                'buy', 'purchase', 'paid user', 'pro user', 'premium user'
            ];
            
            // Free indicators
            const freeKeywords = [
                'free', 'free version', 'free user', 'trial', 'free trial',
                'upgrade to', 'consider upgrading', 'free tier'
            ];
            
            const combinedText = messageLower + ' ' + authorLower;
            
            if (premiumKeywords.some(keyword => combinedText.includes(keyword))) {
                return 'premium';
            }
            
            if (freeKeywords.some(keyword => combinedText.includes(keyword))) {
                return 'free';
            }
            
            return 'unknown';
        }

        function extractKeywords(message) {
            if (!message) return [];
            
            // Common feature keywords to look for
            const featureKeywords = [
                'performance', 'speed', 'fast', 'slow', 'lag', 'crash', 'bug', 'error',
                'interface', 'ui', 'design', 'layout', 'navigation', 'menu',
                'notification', 'alert', 'reminder', 'push notification',
                'sync', 'backup', 'export', 'import', 'download', 'upload',
                'search', 'filter', 'sort', 'organize', 'categorize',
                'security', 'privacy', 'password', 'login', 'authentication',
                'offline', 'online', 'internet', 'connection', 'network',
                'customization', 'settings', 'preferences', 'configuration',
                'support', 'help', 'documentation', 'tutorial', 'guide',
                'update', 'upgrade', 'version', 'new feature', 'improvement',
                'pricing', 'cost', 'price', 'expensive', 'cheap', 'value',
                'mobile', 'desktop', 'web', 'app', 'application',
                'integration', 'api', 'third party', 'plugin', 'addon'
            ];
            
            const messageLower = message.toLowerCase();
            const foundKeywords = [];
            
            featureKeywords.forEach(keyword => {
                if (messageLower.includes(keyword)) {
                    foundKeywords.push(keyword);
                }
            });
            
            return foundKeywords;
        }

        function extractRating(message) {
            if (!message) return null;
            
            // Look for explicit ratings
            const ratingPatterns = [
                /(\d+)\s*\/\s*5/i,
                /(\d+)\s*out\s*of\s*5/i,
                /(\d+)\s*stars?/i,
                /rating[:\s]*(\d+)/i,
                /(\d+)\s*\/\s*10/i
            ];
            
            for (const pattern of ratingPatterns) {
                const match = message.match(pattern);
                if (match) {
                    let rating = parseInt(match[1]);
                    if (rating > 10) rating = Math.round(rating / 2); // Convert 10-point to 5-point
                    if (rating >= 1 && rating <= 5) return rating;
                }
            }
            
            // Look for sentiment-based ratings
            const positiveWords = ['excellent', 'amazing', 'perfect', 'outstanding', 'fantastic', 'brilliant'];
            const negativeWords = ['terrible', 'awful', 'horrible', 'worst', 'disappointing', 'useless'];
            
            const messageLower = message.toLowerCase();
            
            if (positiveWords.some(word => messageLower.includes(word))) {
                return 5;
            }
            
            if (negativeWords.some(word => messageLower.includes(word))) {
                return 1;
            }
            
            return null;
        }

        function generateKeywordTags() {
            const keywordTags = document.getElementById('keywordTags');
            keywordTags.innerHTML = `
                <span class="badge bg-light text-dark me-2 mb-2" style="cursor: pointer; border: 1px solid var(--light-gray);" onclick="addKeywordFilter('')">
                    <i class="fas fa-times me-1"></i>Clear All
                </span>
            `;
            
            if (allReviews.length === 0) return;
            
            // Count keyword frequency
            const keywordCounts = {};
            allReviews.forEach(review => {
                const keywords = extractKeywords(review.content);
                keywords.forEach(keyword => {
                    keywordCounts[keyword] = (keywordCounts[keyword] || 0) + 1;
                });
            });
            
            // Sort by frequency and take top 20
            const sortedKeywords = Object.entries(keywordCounts)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 20);
            
            sortedKeywords.forEach(([keyword, count]) => {
                const badge = document.createElement('span');
                badge.className = 'badge bg-light text-dark me-2 mb-2';
                badge.style.cssText = 'cursor: pointer; border: 1px solid var(--light-gray);';
                badge.innerHTML = `${keyword} (${count})`;
                badge.onclick = () => addKeywordFilter(keyword);
                keywordTags.appendChild(badge);
            });
        }

        function addKeywordFilter(keyword) {
            if (keyword === '') {
                document.getElementById('keywordSearch').value = '';
            } else {
                document.getElementById('keywordSearch').value = keyword;
            }
            applyFilters();
        }

        function updateSourceCount() {
            document.getElementById('sources-count').textContent = dataSources.length;
        }

        function updateSourceList() {
            const container = document.getElementById('sourcesContainer');
            container.innerHTML = '';

            dataSources.forEach(source => {
                const sourceCard = document.createElement('div');
                sourceCard.className = 'col-lg-3 col-md-6 mb-3';
                sourceCard.innerHTML = `
                    <div class="source-card active" data-source="${source.id}">
                        <i class="fas fa-file-${source.type === 'csv' ? 'csv' : source.type === 'json' ? 'code' : 'excel'} fa-3x mb-3" style="color: var(--primary-black);"></i>
                        <h6 class="fw-bold">${source.name}</h6>
                        <span class="badge bg-success mb-2">Active</span>
                        <p class="small mb-2">${source.data.length} reviews</p>
                        <div class="btn-group w-100">
                            <button class="btn btn-sm btn-outline-primary" onclick="editSource(${source.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger" onclick="removeSource(${source.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(sourceCard);
            });
        }

        function updateSourceFilter() {
            const sourceFilter = document.getElementById('sourceFilter');
            sourceFilter.innerHTML = '<option value="">All Sources</option>';
            
            const uniqueSources = [...new Set(allReviews.map(r => r.source))];
            uniqueSources.forEach(source => {
                const option = document.createElement('option');
                option.value = source;
                option.textContent = source;
                sourceFilter.appendChild(option);
            });
        }

        function updateReviewsTable() {
            const tbody = document.getElementById('reviewsTableBody');
            tbody.innerHTML = '';

            if (allReviews.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="text-center" style="color: var(--medium-gray); padding: 3rem;">
                            <i class="fas fa-database fa-3x mb-3"></i>
                            <p>No data loaded. Upload CSV files in the Data Sources tab.</p>
                        </td>
                    </tr>
                `;
                return;
            }

            allReviews.slice(0, 50).forEach(review => {
                const userType = analyzeUserType(review.content, review.author);
                const extractedRating = extractRating(review.content) || review.rating;
                const keywords = extractKeywords(review.content);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${review.date || 'N/A'}</td>
                    <td><span class="badge badge-source">${review.source || 'Unknown'}</span></td>
                    <td>${review.author || 'Anonymous'}</td>
                    <td><span class="badge ${userType === 'premium' ? 'bg-dark' : userType === 'free' ? 'bg-light text-dark' : 'bg-secondary'}">${userType}</span></td>
                    <td>${(review.content || '').substring(0, 150)}${(review.content || '').length > 150 ? '...' : ''}</td>
                    <td>${extractedRating ? generateStars(extractedRating) : 'N/A'}</td>
                    <td>${keywords.length > 0 ? keywords.slice(0, 3).map(k => `<span class="badge bg-light text-dark me-1">${k}</span>`).join('') : 'None'}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewReview('${review.date}', '${review.source}')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Generate keyword tags after updating table
            generateKeywordTags();
        }

        function generateStars(rating) {
            return `<span class="badge bg-light text-dark" style="border: 1px solid var(--github-border);">${rating}</span>`;
        }

        function applyFilters() {
            const sourceFilter = document.getElementById('sourceFilter').value;
            const userTypeFilter = document.getElementById('userTypeFilter').value;
            const ratingFilter = document.getElementById('ratingFilter').value;
            const keywordSearch = document.getElementById('keywordSearch').value.toLowerCase();
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            let filteredReviews = allReviews.filter(review => {
                if (sourceFilter && review.source !== sourceFilter) return false;
                
                // Check user type
                if (userTypeFilter) {
                    const userType = analyzeUserType(review.content, review.author);
                    if (userType !== userTypeFilter) return false;
                }
                
                // Check rating (both extracted and original)
                if (ratingFilter) {
                    const extractedRating = extractRating(review.content) || review.rating;
                    if (extractedRating != ratingFilter) return false;
                }
                
                if (keywordSearch && !review.content.toLowerCase().includes(keywordSearch)) return false;
                if (startDate && review.date < startDate) return false;
                if (endDate && review.date > endDate) return false;
                return true;
            });

            // Update results count
            document.getElementById('resultsCount').textContent = filteredReviews.length;
            
            // Update filter summary
            const filters = [];
            if (sourceFilter) filters.push(`Source: ${sourceFilter}`);
            if (userTypeFilter) filters.push(`User Type: ${userTypeFilter}`);
            if (ratingFilter) filters.push(`Rating: ${ratingFilter} stars`);
            if (keywordSearch) filters.push(`Keyword: "${keywordSearch}"`);
            
            document.getElementById('filterSummary').textContent = 
                filters.length > 0 ? `Filters: ${filters.join(', ')}` : '';

            // Update table with filtered data
            updateFilteredTable(filteredReviews);
        }

        function updateFilteredTable(reviews) {
            const tbody = document.getElementById('reviewsTableBody');
            tbody.innerHTML = '';

            reviews.slice(0, 50).forEach(review => {
                const userType = analyzeUserType(review.content, review.author);
                const extractedRating = extractRating(review.content) || review.rating;
                const keywords = extractKeywords(review.content);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${review.date || 'N/A'}</td>
                    <td><span class="badge badge-source">${review.source || 'Unknown'}</span></td>
                    <td>${review.author || 'Anonymous'}</td>
                    <td><span class="badge ${userType === 'premium' ? 'bg-dark' : userType === 'free' ? 'bg-light text-dark' : 'bg-secondary'}">${userType}</span></td>
                    <td>${(review.content || '').substring(0, 150)}${(review.content || '').length > 150 ? '...' : ''}</td>
                    <td>${extractedRating ? generateStars(extractedRating) : 'N/A'}</td>
                    <td>${keywords.length > 0 ? keywords.slice(0, 3).map(k => `<span class="badge bg-light text-dark me-1">${k}</span>`).join('') : 'None'}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewReview('${review.date}', '${review.source}')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function clearFilters() {
            document.getElementById('sourceFilter').value = '';
            document.getElementById('userTypeFilter').value = '';
            document.getElementById('ratingFilter').value = '';
            document.getElementById('keywordSearch').value = '';
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            
            document.getElementById('resultsCount').textContent = allReviews.length;
            document.getElementById('filterSummary').textContent = '';
            
            updateReviewsTable();
        }

        function removeSource(sourceId) {
            if (confirm('Are you sure you want to remove this data source?')) {
                const sourceIndex = dataSources.findIndex(s => s.id === sourceId);
                if (sourceIndex !== -1) {
                    const source = dataSources[sourceIndex];
                    dataSources.splice(sourceIndex, 1);
                    
                    // Remove reviews from this source
                    allReviews = allReviews.filter(r => !source.data.includes(r));
                    
                    // Update UI
                    updateSourceCount();
                    updateSourceList();
                    updateDashboardMetrics(allReviews);
                    updateReviewsTable();
                    updateSourceFilter();
                    
                    alert(`Removed ${source.name} and ${source.data.length} reviews`);
                }
            }
        }

        function editSource(sourceId) {
            alert('Edit functionality not yet implemented');
        }

        function viewReview(date, source) {
            alert(`Viewing review from ${date} (${source})`);
        }

        function updateTime() {
            const now = new Date();
            document.getElementById('last-updated').textContent = now.toLocaleString();
        }
    </script>
</body>
</html>
